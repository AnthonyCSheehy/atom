<div ng-class="{ cb: true, content: true, 'cb-fullscreen': isFullscreen, 'cb-maximized': isMaximized }">

  <section class="cb-inner">

    <!-- Header -->
    <div class="cb-menu menu-list">

      <!-- Heading -->
      <ul class="menu-list-left">
        <li><h2>Context browser</h2></li>
      </ul>

      <!-- Menu -->
      <ul class="menu-list-right nav nav-pills">

        <!-- Toogle relationships -->
        <li ng-class="{ active: areRelationshipsHidden }">
          <a href class="hide_relationships" ng-click="hideRelationships()">
            {{ areRelationshipsHidden ? 'Show relationships' : 'Hide relationships' }}
          </a>
        </li>

        <!-- Fullscreen -->
        <li ng-class="{ active: isFullscreen }">
          <a href ng-click="toggleFullscreenMode()" class="fullscreen">
            {{ isFullscreen ? 'Exit fullscreen' : 'Fullscreen' }}
          </a>
        </li>

        <!-- Maximize -->
        <li ng-if="!isFullscreen">
          <a href ng-click="toggleMaximizedMode()" ng-class="{ maximize: !isMaximized, minimize: isMaximized }">
            {{ isMaximized ? 'Minimize' : 'Maximize' }}
          </a>
        </li>

        <!-- Ranking direction -->
        <li class="dropdown">
          <a href class="rankdir dropdown-toggle" data-toggle="dropdown">Ranking direction</a>
          <ul class="dropdown-menu">
            <li ng-repeat="(key, value) in rankingDirections" ng-class="{ active: rankDir == key }">
              <a href ng-click="changeRankingDirection(key)">{{ value }}</a>
            </li>
          </ul>
        </li>

        <!-- Collapse all -->
        <li>
          <a href ng-click="collapseAll()" class="expand_all">Collapse all</a>
        </li>

      </ul>

    </div>

    <!-- Body -->
    <div class="cb-body">

      <!-- Context browser -->
      <div class="cb-container">

        <!-- Container -->
        <div class="svg-container"/>

        <!-- Legend -->
        <div ng-class="{ 'cb-legend': true, 'active': showLegend }">
          <a href class="cb-legend-open" ng-click="toggleLegend()" ng-show="!showLegend"><i class="icon-compass"></i></a>
          <div ng-show="showLegend" class="cb-legend-container">
            <a href class="cb-legend-close" ng-click="toggleLegend()"><i class="icon-remove"></i></a>
            <ul class="nav nav-stacked">
              <li class="drmc-color-artwork-record">Artwork record</li>
              <li class="drmc-color-description">Description</li>
              <li class="drmc-color-component">Component</li>
              <li class="drmc-color-artist-supplied-master">Artist supplied master</li>
              <li class="drmc-color-artist-verified-proof">Artist verified proof</li>
              <li class="drmc-color-archival-master">Archival master</li>
              <li class="drmc-color-exhibition-format">Exhibition format</li>
              <li class="drmc-color-documentation">Documentation</li>
              <li class="drmc-color-miscellaneous">Miscellaneous</li>
              <li class="drmc-color-aip">AIP</li>
            </ul>
          </div>
        </div>

      </div>

      <!-- Sidebar -->
      <div class="cb-sidebar">

        <div class="cb-sidebar-top">

          <!-- Bulk edit -->
          <div ng-if="hasNodesSelected()" class="cb-sidebar-section cb-bulk-edit">
            <h3>Bulk edit ({{ getNumberOfSelectedNodes() }} items)</h3>
            <div class="node-metadata">
              <ul>
                <li ng-repeat="node in activeNodes">{{ node.data.title }}</li>
              </ul>
            </div>
            <div class="node-actions">
              <!-- <a href class="btn btn-small" ng-click="moveNodes('selected')"><i class="icon-move"></i><span>Move</span></a> -->
              <!-- <a href class="btn btn-small" ng-click="linkNodes('selected')"><i class="icon-link"></i><span>Link</span></a> -->
              <!-- <a href class="btn btn-small btn-delete" ng-show="isDeletable(currentNode)" ng-click="deleteNodes('selected')"><i class="icon-remove"></i><span>Delete</span></a> -->
              <a href class="btn btn-small" ng-click="cancelBulkEdit()">Cancel</a>
            </div>
          </div>

          <!-- Single node detail -->
          <div ng-if="hasNodeSelected()" class="cb-sidebar-section">
            <h3 class="drmc-color-{{ currentNode.data.level }}">{{ currentNode.data.title }}</h3>

            <!-- TMS metadata -->
            <div ng-if="currentNode.data.tms" class="cb-sidebar-subsection cb-sidebar-subsection-collapsible" ng-class="{ collapsed: tmsCollapsed }">
              <h4><a href ng-click="tmsCollapsed = !tmsCollapsed">TMS metadata</a></h4>
              <div ng-show="!tmsCollapsed" class="cb-sidebar-subsection-body cb-sidebar-kv-list">
                <ul>
                  <li ng-repeat="(key, value) in currentNode.data.tms">
                    <strong class="key">{{ key }}</strong>
                    <p class="value">{{ renderMetadataValue(value) }}</p>
                  </li>
                </ul>
              </div>
            </div>

            <!-- Dublin Core metadata -->
            <div ng-if="currentNode.data.dc" class="cb-sidebar-subsection cb-sidebar-subsection-collapsible" ng-class="{ collapsed: dcCollapsed }">
              <h4><a href ng-click="dcCollapsed = !dcCollapsed">Dublin Core metadata</a></h4>
              <div ng-show="!dcCollapsed" class="cb-sidebar-subsection-body cb-sidebar-kv-list">
                <ul>
                  <li ng-repeat="(key, value) in currentNode.data.dc">
                    <strong class="key">{{ key }}</strong>
                    <p class="value">{{ renderMetadataValue(value) }}</p>
                  </li>
                </ul>
              </div>
            </div>

            <!-- File list -->
            <div ng-if="hasFiles()" class="cb-sidebar-subsection cb-file-list cb-sidebar-subsection-collapsible" ng-class="{ collapsed: filesCollapsed }">
              <h4 class="cb-file-list-mode-select">
                <a href ng-click="filesCollapsed = !filesCollapsed">Files ({{ files.length }} items)</a>
                <div class="modes" ng-show="!filesCollapsed">
                  <a ng-class="{ mode: true, 'mode-list': true, active: fileListViewMode  == 'list' }" href ng-click="fileListViewMode = 'list'"><i class="icon icon-align-justify"></i></a>
                  <a ng-class="{ mode: true, 'mode-thumbnails': true, active: fileListViewMode  == 'thumbnails' }" href ng-click="fileListViewMode = 'thumbnails'"><i class="icon icon-th-large"></i></a>
                </div>
              </h4>
              <div ng-if="!filesCollapsed">
                <!-- Mode "list" -->
                <div ng-if="fileListViewMode == 'list'" class="cb-sidebar-subsection-body cb-sidebar-table">
                  <table class="table">
                    <tbody>
                      <tr ng-repeat="file in files" ng-click="selectFile(file, $event, $index)" ng-class="{ selected: file.selected == true }">
                        <td class="name">
                          <a href>{{ file.filename }}</a>
                        </td>
                        <td class="size">{{ file.byteSize | UnitFilter:2 }}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <!-- Mode "thumbnails" -->
                <div ng-if="fileListViewMode == 'thumbnails'" class="cb-sidebar-subsection-body cb-sidebar-thumbnails">
                  <div ng-click="selectFile(file, $event, $index)" ng-repeat="file in files" ng-class="{ item: true, selected: file.selected == true }">
                    <div class="preview">
                      <img ng-src="{{ file.thumbnailPath }}"/>
                    </div>
                    <div class="footer">
                      {{ file.filename }}
                    </div>
                  </div>
                </div>
                <!-- Selection options -->
                <div class="cb-file-options" ng-show="hasSelectedFiles()">
                  <ul class="nav">
                    <li><a class="btn btn-small" href ng-click="openViewer()">View all</a></li>
                    <li><a class="btn btn-small" href ng-click="cancelFileSelection()">Cancel</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- Actions -->
            <div class="node-actions">
              <a href class="btn btn-small" ng-click="addChildNode(currentNode.id)"><i class="icon-plus"></i><span>Add child</span></a>
              <a href class="btn btn-small" ng-click="editNode(currentNode.id)"><i class="icon-edit"></i><span>Edit node</span></a>
              <a href class="btn btn-small" ng-click="linkNodes(currentNode.id)"><i class="icon-link"></i><span>Link node</span></a>
              <a href class="btn btn-small" ng-click="moveNodes(currentNode.id)"><i class="icon-move"></i><span>Move</span></a>
              <a href class="btn btn-small" ng-click="openTechModal(currentNode.id)"><i class="icon-wrench"></i><span>AddTech</span></a>
              <a href class="btn btn-small btn-delete" ng-show="isDeletable(currentNode)" ng-click="deleteNodes(currentNode.id)"><i class="icon-remove"></i><span>Delete</span></a>
            </div>

          </div>

        </div>

      </div>

    </div>

  </section>

</div>
